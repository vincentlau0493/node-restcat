{
  "name": "deasync",
  "version": "0.0.7",
  "description": "Turns async function into sync via JavaScript wrapper of Node event loop",
  "main": "index.js",
  "author": {
    "name": "Vladimir Kurchatkin",
    "email": "vladimir.kurchatkin@gmail.com"
  },
  "contributors": [
    {
      "name": "Fred Wen",
      "email": "wenfred@gmail.com",
      "url": "https://github.com/abbr"
    }
  ],
  "license": "MIT",
  "scripts": {
    "install": "node ./build.js"
  },
  "dependencies": {
    "bindings": "~1.1.1"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/abbr/deasync.git"
  },
  "homepage": "https://github.com/abbr/deasync",
  "keywords": [
    "async",
    "sync",
    "sleep",
    "async wrapper"
  ],
  "readme": "deasync\r\n=======\r\ndeasync turns async function into sync, implemented with a blocking mechanism by way of calling Node.js event loop at JavaScript layer. The core of deasync is writen in C++.\r\n\r\n## Motivation\r\nSuppose you maintain a library that exposes a function <code>getData</code>. Your users call it to get actual data:   \r\n<code>var output = getData();</code>  \r\nUnder the hood data is saved in a file so you implemented <code>getData</code> using Node.js built-in <code>fs.readFileSync</code>. It's obvious both <code>getData</code> and <code>fs.readFileSync</code> are sync functions. One day you were told to switch the underlying data source to a repo such as MongoDB which can only be accessed asynchronously. You were also told to avoid pissing off your users, <code>getData</code> API cannot be changed to return merely a promise or demand a callback parameter. How do you meet both requirements?\r\n\r\nYou may tempted to use [node-fibers](https://github.com/laverdet/node-fibers) or a module derived from it, but node fibers can only wrap async function call into a sync function inside a fiber. In the case above you cannot assume all  callers are inside fibers. For similar reason ES6 generators won't work either. \r\n\r\nWhat really needed is a way to block subsequent JavaScript from running without blocking entire thread by yielding to allow other events in the event loop to be handled. Ideally the blockage is removed as soon as the result of async function is available. A less ideal but acceptable alternative is a `sleep` function which you can use to implement the blockage like ```while(!done) sleep(100);```. It is less ideal because sleep duration has to be guessed. It is important the `sleep` function not only shouldn't block entire thread, but also shouldn't incur busy wait that pegs the CPU to 100%. \r\n\r\ndeasync supports both alternatives.\r\n\r\n## Usages\r\n* Generic wrapper of async function with standard API signature `function(p1,...pn,function cb(err,res){})`\r\n\r\n```\r\nvar deasync = require('deasync');\r\nvar cp = require('child_process');\r\nvar exec = deasync(cp.exec);\r\n// output result of ls -la\r\nconsole.log(exec('ls -la'));\r\n// done is printed last, as supposed, with cp.exec wrapped in deasync; first without.\r\nconsole.log('done');\r\n```\r\n\r\n* For async function with non-standard API, for instance `function asyncFunction(p1,function cb(res){})`, use `runLoopOnce`\r\n\r\n```\r\nvar done = false;\r\nvar data;\r\nasyncFunction(p1,function cb(res){\r\n  data = res;\r\n  done = true;\r\n});\r\nwhile(!done) {\r\n  require('deasync').runLoopOnce();\r\n}\r\n// data is now populated\r\n```\r\n\r\n* Sleep (a wrapper of setTimeout)\r\n\r\n```\r\nfunction SyncFunction(){\r\n  var ret;\r\n  setTimeout(function(){\r\n      ret = \"hello\";\r\n  },3000);\r\n  while(ret === undefined) {\r\n    require('deasync').sleep(100);\r\n  }\r\n  // returns hello with sleep; undefined without\r\n  return ret;    \r\n}\r\n```\r\n\r\n\r\n## Installation\r\nPrerequisites: Except on a few platforms where binary distribution is included, deasync uses node-gyp to compile C++ source code so you may need the compilers listed in [node-gyp](https://github.com/TooTallNate/node-gyp). \r\n\r\nTo install, run \r\n```npm install deasync```\r\n\r\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/abbr/deasync/issues"
  },
  "_id": "deasync@0.0.7",
  "_from": "deasync@*"
}
